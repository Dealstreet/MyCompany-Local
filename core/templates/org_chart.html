{% extends "base.html" %}

{% block title %}ì¡°ì§ë„ - ê¼¼ë§ì»´í¼ë‹ˆ CIS{% endblock %}

{% block content %}
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<style>
    /* ì„¸ë¡œ ê°„ê²© */

    .org-container {
        padding: 30px;
        background-color: #f1f5f9;
        min-height: 100vh;
        overflow: auto;
    }

    /* ë…¸ë“œ ì¹´ë“œ ê³µí†µ ë””ìì¸ */
    .node-card {
        width: 160px;
        padding: 10px;
        border-radius: 8px;
        background: white;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        border: 1px solid #e2e8f0;
        cursor: pointer;
        transition: 0.2s;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        color: inherit;
    }

    .node-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 12px rgba(0, 0, 0, 0.1);
        border-color: #3b82f6;
    }

    /* CEO ìŠ¤íƒ€ì¼ */
    .ceo-card {
        border-top: 4px solid #3b82f6;
        background: #fff;
    }

    .profile-icon {
        font-size: 24px;
        margin-bottom: 5px;
    }

    /* ë¶€ì„œì¥ ìŠ¤íƒ€ì¼ */
    .dept-card {
        background: #1e293b;
        color: white;
        border: none;
        width: 140px;
    }

    .dept-card .node-name {
        color: white;
        font-weight: bold;
    }

    /* ì§ì› ìŠ¤íƒ€ì¼ */
    .agent-card {
        min-height: 100px;
    }

    .img-circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #f1f5f9;
        margin-bottom: 8px;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 1px solid #e2e8f0;
        font-size: 20px;
    }

    /* í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
    .node-name {
        font-weight: 800;
        font-size: 14px;
        margin-bottom: 2px;
        color: #1e293b;
    }

    .node-role {
        font-size: 11px;
        color: #64748b;
    }

    /* êµ¬ê¸€ ì°¨íŠ¸ ê¸°ë³¸ ì„ íƒ/í˜¸ë²„ íš¨ê³¼ ì™„ì „ ì œê±° */
    .google-visualization-orgchart-node,
    .google-visualization-orgchart-nodesel,
    .google-visualization-orgchart-node-over {
        border: none !important;
        background-color: transparent !important;
        background: transparent !important;
        box-shadow: none !important;
    }

    .google-visualization-orgchart-node-medium {
        font-size: 1em;
    }
</style>

<div class="org-container">
    <div class="d-flex align-items-center mb-4 gap-2">
        <h2 class="fw-bold text-dark m-0">ğŸ‘¥ ì¡°ì§ë„ ë³´ê¸°</h2>
    </div>
    <div class="d-flex justify-content-center">
        <div id="chart_div"></div>
    </div>
</div>

<script type="text/javascript">
    google.charts.load('current', { packages: ["orgchart"] });
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Name');
        data.addColumn('string', 'Manager');
        data.addColumn('string', 'ToolTip');

        // Djangoì—ì„œ ë„˜ê²¨ì¤€ ë°ì´í„° íŒŒì‹±
        var chartData = JSON.parse('{{ chart_data|escapejs }}');
        data.addRows(chartData);

        // ì°¨íŠ¸ ê·¸ë¦¬ê¸°
        var chart = new google.visualization.OrgChart(document.getElementById('chart_div'));
        chart.draw(data, { 'allowHtml': true, 'nodeClass': 'my-node' });
    }
</script>
{% endblock %}