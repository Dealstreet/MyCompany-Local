{% load humanize %}
<div class="card-header-modern">
    <span>ğŸ“œ ìš´ìš© ë¡œê·¸ (Operational Logs)</span>
    <span style="font-size:12px; color:#64748b;">ë§¤ìˆ˜/ë§¤ë„ ì´ë ¥</span>
</div>
<div style="overflow-x:auto;">
    <table class="modern-table">
        <thead>
            <tr>
                <th width="10%">ì¶œì²˜</th>
                <th width="15%">ì¼ì‹œ</th>
                <th width="10%">êµ¬ë¶„</th>
                <th width="15%">ì¢…ëª©ëª…</th>
                <th width="10%">ë§¤ìˆ˜ê³„ì¢Œ</th> <!-- [New] -->
                <th width="10%" class="text-end">ìˆ˜ëŸ‰</th>
                <th width="15%" class="text-end">í‰ê· ë‹¨ê°€</th>
                <th width="15%" class="text-end">ê±°ë˜ê¸ˆì•¡</th>
            </tr>
        </thead>
        <tbody>
            {% for log in investment_logs %}
            <tr>
                <td>
                    {% if log.source == 'ceo' %}
                    <span class="badge bg-primary">ğŸ‘‘ CEO</span>
                    {% elif log.source == 'sms' %}
                    <span class="badge bg-success">ğŸ“± ë¬¸ì</span>
                    {% else %}
                    <span class="badge bg-secondary">ğŸ¤– ê¸°íƒ€</span>
                    {% endif %}
                </td>
                <td class="text-secondary small">{{ log.approved_at|date:"y.m.d H:i" }}</td>
                <td>
                    {% if log.quantity > 0 %}
                    <span class="badge bg-danger bg-opacity-10 text-danger small">ë§¤ìˆ˜</span>
                    {% else %}
                    <span class="badge bg-primary bg-opacity-10 text-primary small">ë§¤ë„</span>
                    {% endif %}
                </td>
                <td class="fw-bold">{{ log.stock_name|default:log.stock_code }}</td>
                <td class="small">
                    {% if log.account %}
                    {{ log.account.nickname|default:log.account.financial_institution }}
                    {% else %}
                    -
                    {% endif %}
                </td> <!-- [New] -->
                <td class="text-end fw-bold">{{ log.quantity|stringformat:"+d"|intcomma }}ì£¼</td> <!-- ë¶€í˜¸ í‘œì‹œ -->
                <td class="text-end">
                    {% if log.stock_obj.country == 'USA' %}
                    ${{ log.avg_price|floatformat:2|intcomma }}
                    {% else %}
                    {{ log.avg_price|floatformat:0|intcomma }}ì›
                    {% endif %}
                </td>
                <td class="text-end text-dark">
                    {% if log.stock_obj.country == 'USA' %}
                    ${{ log.total_amount|floatformat:2|intcomma }}
                    {% else %}
                    {{ log.total_amount|intcomma }}ì›
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8" style="text-align: center; padding: 40px; color: #94a3b8;">
                    ìš´ìš© ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- í˜ì´ì§€ë„¤ì´ì…˜ ì»¨íŠ¸ë¡¤ -->
    {% if investment_logs.has_other_pages %}
    <div class="d-flex justify-content-center p-3 gap-2">
        {% if investment_logs.has_previous %}
        <button class="btn btn-sm btn-outline-secondary btn-page"
            data-page="{{ investment_logs.previous_page_number }}">&lt;</button>
        {% endif %}

        <span class="d-flex align-items-center text-muted small px-2">
            Page {{ investment_logs.number }} of {{ investment_logs.paginator.num_pages }}
        </span>

        {% if investment_logs.has_next %}
        <button class="btn btn-sm btn-outline-secondary btn-page"
            data-page="{{ investment_logs.next_page_number }}">&gt;</button>
        {% endif %}
    </div>
    {% endif %}
</div>