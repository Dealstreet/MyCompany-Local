{% extends 'base.html' %}
{% block title %}ì „ìê²°ì¬í•¨ - ê¼¼ë§ì»´í¼ë‹ˆ CIS{% endblock %}

{% block content %}
<style>
    /* ì „ì²´ ì»¨í…Œì´ë„ˆ */
    .approval-container {
        padding: 40px;
        background-color: #f8fafc;
        min-height: 100vh;
    }

    /* 1. í—¤ë” ë° ì‘ì„± ë²„íŠ¼ */
    .page-header {
        display: flex; justify-content: space-between; align-items: center;
        margin-bottom: 30px;
    }
    .page-title { font-size: 24px; font-weight: 800; color: #1e293b; }
    
    .btn-new {
        background-color: #3b82f6; color: white; padding: 10px 20px;
        border-radius: 8px; font-weight: 700; text-decoration: none;
        box-shadow: 0 4px 6px rgba(59, 130, 246, 0.2); transition: 0.2s;
    }
    .btn-new:hover { background-color: #2563eb; transform: translateY(-2px); }

    /* 2. í•„í„° íƒ­ (í•µì‹¬ UI) */
    .filter-tabs {
        display: flex; gap: 10px; margin-bottom: 20px;
        border-bottom: 1px solid #e2e8f0; padding-bottom: 15px;
    }
    
    .tab-item {
        padding: 8px 16px; border-radius: 20px; font-size: 14px; font-weight: 600;
        text-decoration: none; color: #64748b; background: white;
        border: 1px solid #e2e8f0; transition: all 0.2s;
    }
    
    .tab-item:hover { background-color: #f1f5f9; }
    
    /* í™œì„±í™”ëœ íƒ­ ìŠ¤íƒ€ì¼ */
    .tab-item.active {
        background-color: #1e293b; color: white; border-color: #1e293b;
    }
    
    /* 3. ë¬¸ì„œ ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ */
    .doc-list { display: flex; flex-direction: column; gap: 15px; }

    .doc-item {
        background: white; padding: 20px; border-radius: 12px;
        border: 1px solid #e2e8f0; display: flex; align-items: center;
        justify-content: space-between; transition: 0.2s; cursor: pointer;
        text-decoration: none; color: inherit;
    }
    .doc-item:hover {
        transform: translateY(-3px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.05);
        border-color: #cbd5e1;
    }

    /* ë¬¸ì„œ ì •ë³´ */
    .doc-info { display: flex; flex-direction: column; gap: 5px; }
    .doc-title { font-size: 16px; font-weight: 700; color: #1e293b; }
    .doc-meta { font-size: 13px; color: #94a3b8; display: flex; gap: 10px; align-items: center; }

    /* ìƒíƒœ ë±ƒì§€ (Status Badge) */
    .status-badge {
        padding: 6px 12px; border-radius: 8px; font-size: 12px; font-weight: 800;
        display: flex; align-items: center; gap: 5px; min-width: 80px; justify-content: center;
    }
    
    /* ìƒíƒœë³„ ìƒ‰ìƒ */
    .status-pending { background-color: #fff7ed; color: #ea580c; border: 1px solid #ffedd5; } /* ì£¼í™© */
    .status-approved { background-color: #f0fdf4; color: #16a34a; border: 1px solid #dcfce7; } /* ì´ˆë¡ */
    .status-rejected { background-color: #fef2f2; color: #dc2626; border: 1px solid #fee2e2; } /* ë¹¨ê°• */
    .status-draft { background-color: #f8fafc; color: #64748b; border: 1px solid #e2e8f0; } /* íšŒìƒ‰ */

    /* ë°ì´í„° ì—†ìŒ */
    .empty-state {
        text-align: center; padding: 60px; color: #94a3b8;
        font-size: 15px; font-weight: 500;
    }
</style>

<div class="approval-container">
    <div class="page-header">
        <div class="page-title">ğŸ“‚ ì „ìê²°ì¬í•¨</div>
        <a href="{% url 'create_self_approval' %}" class="btn-new">âœï¸ ì§ì ‘ ê¸°ì•ˆ ì‘ì„±</a>
    </div>

    <div class="filter-tabs">
        <a href="?status=all" class="tab-item {% if current_status == 'all' %}active{% endif %}">ì „ì²´ ë¬¸ì„œ</a>
        <a href="?status=pending" class="tab-item {% if current_status == 'pending' %}active{% endif %}">â³ ëŒ€ê¸°ì¤‘</a>
        <a href="?status=approved" class="tab-item {% if current_status == 'approved' %}active{% endif %}">âœ… ìŠ¹ì¸ë¨</a>
        <a href="?status=rejected" class="tab-item {% if current_status == 'rejected' %}active{% endif %}">âŒ ë°˜ë ¤ë¨</a>
    </div>

    <div class="doc-list">
        {% for doc in approvals %}
        <a href="{% url 'approval_detail' doc.id %}" class="doc-item">
            <div class="doc-info">
                <div class="doc-title">
                    {% if doc.report_type == 'buy' %}ğŸ“ˆ [ë§¤ìˆ˜]{% elif doc.report_type == 'sell' %}ğŸ“‰ [ë§¤ë„]{% else %}ğŸ“„ [ì¼ë°˜]{% endif %}
                    {{ doc.title }}
                </div>
                <div class="doc-meta">
                    <span>ê¸°ì•ˆì: {% if doc.agent %}{{ doc.agent.name }}{% else %}{{ doc.drafter.username }}{% endif %}</span>
                    <span>|</span>
                    <span>{{ doc.created_at|date:"Y-m-d H:i" }}</span>
                </div>
            </div>

            <div>
                {% if doc.status == 'pending' %}
                    <div class="status-badge status-pending">â³ ê²°ì¬ ëŒ€ê¸°</div>
                {% elif doc.status == 'approved' %}
                    <div class="status-badge status-approved">âœ… ìŠ¹ì¸ ì™„ë£Œ</div>
                {% elif doc.status == 'rejected' %}
                    <div class="status-badge status-rejected">âŒ ë°˜ë ¤ë¨</div>
                {% else %}
                    <div class="status-badge status-draft">ì„ì‹œ ì €ì¥</div>
                {% endif %}
            </div>
        </a>
        {% empty %}
        <div class="empty-state">
            í•´ë‹¹í•˜ëŠ” ë¬¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤.
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}